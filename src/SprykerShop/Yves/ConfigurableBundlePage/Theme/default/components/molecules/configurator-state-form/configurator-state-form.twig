{% extends model('component') %}

{% define config = {
    name: 'configurator-state-form',
} %}

{% define data = {
    form: required,
    action: required,
    submitButtonText: '',
    submitButtonModifiers: ['expand'],
    isExtraModifier: false,
    idConfigurableBundleTemplateSlot: null,
    selectedSlotId: null,
    isSeparateItem: false,
    isSubmitButtonActive: true,
    method: 'GET',

} %}

{% block body %}
    {{ form_start(data.form,  {'action': data.action, 'method': data.method}) }}

    {% for slotForm in data.form.slots %}
        {{ form_row(slotForm.sku, { id: '' }) }}
    {% endfor %}

    {% block action %}
        {% set isSelectedProduct = data.form.slots[data.idConfigurableBundleTemplateSlot].vars.value.sku is defined %}

        {% if isSelectedProduct and data.isExtraModifier %}
            {% set extraModifier = 'selected' %}
        {%- endif %}

        {% if data.idConfigurableBundleTemplateSlot == data.selectedSlotId and not data.isSeparateItem and data.isExtraModifier %}
            {% set extraModifier = 'active' %}
        {%- endif %}

        {% block button %}
            {% set buttonModifiers = extraModifier is defined ? data.submitButtonModifiers | merge([extraModifier]) : data.submitButtonModifiers %}
            {% set buttonAttributes = not data.isSubmitButtonActive ? {disabled: 'disabled'} : {} %}

            {% block buttonInner %}
                {% include molecule('configurator-button', 'ConfigurableBundlePage') with {
                    modifiers: buttonModifiers,
                    attributes: buttonAttributes,
                    data: {
                        text: data.submitButtonText,
                    },
                } only %}
            {% endblock %}
        {% endblock %}
    {% endblock %}

    {{ form_row(data.form._token,{ id: '' }) }}
    {{ form_end(data.form) }}
{% endblock %}
