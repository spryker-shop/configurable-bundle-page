{% extends model('component') %}

{% define config = {
    name: 'selected-product-list',
} %}

{% define data = {
    products: required,
    form: required,
    configurableBundleTemplateStorage: required,
} %}

{% block body %}
    {% for idSlot, slotForm in data.form.createView.slots %}
        {% set sku = slotForm.vars.value.sku %}

        {% block productSection %}
            {% block heading %}
                <div class="{{ config.name }}__header grid grid--justify grid--middle">
                    {% block headingInner %}
                        {% block title %}
                            <h6 class="col col--sm-10">
                                {{ data.configurableBundleTemplateStorage.slots[idSlot].name | trans }}
                            </h6>
                        {% endblock %}

                        {% block form %}
                            <span class="col col--sm-1">
                                {% include molecule('configurator-state-form', 'ConfigurableBundlePage') with {
                                    data: {
                                        form: data.form.createView,
                                        submitButtonText: 'configurable_bundle_page.edit' | trans,
                                        action: path(
                                            'configurable-bundle/configurator/slots', {
                                                'idConfigurableBundleTemplate': data.configurableBundleTemplateStorage.idConfigurableBundleTemplate,
                                                'idConfigurableBundleTemplateSlot': data.configurableBundleTemplateStorage.slots[idSlot].idConfigurableBundleTemplateSlot,
                                            }
                                        ),
                                    },
                                } only %}
                            </span>
                        {% endblock %}
                    {% endblock %}
                </div>
            {% endblock %}

            {% block product %}
                {% include molecule('configurator-product', 'ConfigurableBundlePage') with {
                    data: {
                        product: data.products[sku],
                        form: data.form.createView,
                        name: data.products[sku].name,
                        selectedSlotId: '',
                        isActionActive: false,
                    },
                } only %}
            {% endblock %}
        {% endblock %}
    {% endfor %}
{% endblock %}
